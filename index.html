<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Max Ricci - Portofolio 2025</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav>
        <div class="logo">Max Ricci</div>
        <ul class="nav-links">
            <li><a href="#work">Work</a></li>
            <li><a href="about.html">About Max</a></li>
            <li><a href="contact.html">Contact</a></li>
        </ul>
    </nav>

    <section class="hero">
        <h1>PERSONAL PORTFOLIO<br>INDUSTRIAL DESIGN<br>2025-2026</h1>
        <div class="subtitle">Portfolio 2025</div>
        <div class="hero-meta">
            <div>
                <span>Based in</span>
                Lugano, CH
            </div>
            <div>
                <span>Discipline</span>
                Design / Art
            </div>
            <div>
                <span>Status</span>
                Available
            </div>
        </div>
    </section>

    <section class="projects-section" id="work">
        <div class="section-header">
            <h2 class="section-title">Selected Works</h2>
            <div class="section-number">[03]</div>
        </div>
        
        <div class="projects-list">
            <div class="project-item">
                <div class="project-number">[01]</div>
                <div class="project-title">THREE O' CLOCK</div>
                <div class="project-description">Time & Perception</div>
                <div class="project-year">2025</div>
            </div>

            <div class="project-item">
                <div class="project-number">[02]</div>
                <div class="project-title">ARCH-ITECTURE</div>
                <div class="project-description">Spatial Forms</div>
                <div class="project-year">2025</div>
            </div>

            <div class="project-item">
                <div class="project-number">[03]</div>
                <div class="project-title">MOI</div>
                <div class="project-description">Visual Diary</div>
                <div class="project-year">2025</div>
            </div>
        </div>
    </section>

    <div class="project-visual" id="projectVisual"></div>
    <script>
        (function(){
            const projects = document.querySelectorAll('.project-item');
            const visual = document.getElementById('projectVisual');

            // Basic hover preview (keeps previous behavior)
            projects.forEach((project, i) => {
                project.addEventListener('mouseenter', () => {
                    if (window.innerWidth > 1024) {
                        visual.style.opacity = '1';
                        const icons = ['ðŸ•’', 'ðŸ›ï¸', 'âœ¨'];
                        visual.textContent = icons[i] || '';
                    }
                });

                project.addEventListener('mouseleave', () => {
                    visual.style.opacity = '0';
                });

                project.addEventListener('click', () => openProjectModal(i));
            });

            // Project data (titles/descriptions from DOM for reliability)
            const projectData = Array.from(projects).map((el, i) => ({
                index: i,
                title: el.querySelector('.project-title')?.textContent || ('Project ' + (i+1)),
                description: el.querySelector('.project-description')?.textContent || '',
                // image prefix to look for in /images â€” convention: project-01-1.jpg
                imagePrefix: `project-${String(i+1).padStart(2,'0')}`
            }));

            // Modal elements
            const modalOverlay = document.getElementById('projectModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalDesc = document.getElementById('modalDesc');
            const modalClose = document.getElementById('modalClose');
            const modalFooter = document.getElementById('modalFooter');
            const carouselImage = document.getElementById('carouselImage');
            const carouselEmpty = document.getElementById('carouselEmpty');
            const prevBtn = document.getElementById('carouselPrev');
            const nextBtn = document.getElementById('carouselNext');

            let currentImages = [];
            let currentIndex = 0;

            function openProjectModal(i){
                const data = projectData[i];
                modalTitle.textContent = data.title;
                modalDesc.textContent = data.description;
                modalFooter.textContent = `${data.title} â€¢ ${data.index+1}`;
                modalOverlay.classList.add('active');
                // try load images matching prefix, up to 6
                loadImagesForProject(data.imagePrefix, 6, (imgs) => {
                    currentImages = imgs;
                    currentIndex = 0;
                    if (currentImages.length){
                        carouselEmpty.style.display = 'none';
                        carouselImage.style.display = '';
                        carouselImage.src = currentImages[0];
                    } else {
                        carouselImage.style.display = 'none';
                        carouselEmpty.style.display = '';
                    }
                });
                // focus trap optional: focus close button
                modalClose.focus();
            }

            function closeModal(){
                modalOverlay.classList.remove('active');
                carouselImage.src = '';
                currentImages = [];
            }

            modalClose.addEventListener('click', closeModal);
            modalOverlay.addEventListener('click', (e)=>{
                if (e.target === modalOverlay) closeModal();
            });

            // keyboard support
            document.addEventListener('keydown', (e)=>{
                if (!modalOverlay.classList.contains('active')) return;
                if (e.key === 'Escape') closeModal();
                if (e.key === 'ArrowLeft') showPrev();
                if (e.key === 'ArrowRight') showNext();
            });

            prevBtn.addEventListener('click', showPrev);
            nextBtn.addEventListener('click', showNext);

            function showPrev(){
                if (!currentImages.length) return;
                currentIndex = (currentIndex - 1 + currentImages.length) % currentImages.length;
                carouselImage.src = currentImages[currentIndex];
            }

            function showNext(){
                if (!currentImages.length) return;
                currentIndex = (currentIndex + 1) % currentImages.length;
                carouselImage.src = currentImages[currentIndex];
            }

            // Attempt to load images with a naming convention: images/{prefix}-{n}.jpg
            function loadImagesForProject(prefix, maxCount, cb){
                const loaded = [];
                let checked = 0;
                const ext = ['jpg','png'];
                function tryNext(n){
                    if (n > maxCount){
                        cb(loaded);
                        return;
                    }
                    // try each extension for this index
                    let extIndex = 0;
                    function tryExt(){
                        if (extIndex >= ext.length){
                            // none for this n
                            checked++;
                            tryNext(n+1);
                            return;
                        }
                        const url = `images/${prefix}-${n}.${ext[extIndex]}`;
                        const img = new Image();
                        img.onload = ()=>{ loaded.push(url); checked++; tryNext(n+1); };
                        img.onerror = ()=>{ extIndex++; tryExt(); };
                        img.src = url;
                    }
                    tryExt();
                }
                tryNext(1);
            }
        })();
    </script>
